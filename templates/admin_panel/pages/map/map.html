<!DOCTYPE html>
<html>
<head>
    <title>Google Maps Example</title>
    <script src="https://maps.googleapis.com/maps/api/js?key={{ api_key }}&callback=initMap" async defer></script>
    <script>
      let map;
      let geocoder;

      function initMap() {
        // Get latitude and longitude from Django template
        const latitude = parseFloat("{{ latitude }}");
        const longitude = parseFloat("{{ longitude }}");
        
        // Initialize map with the provided location
        const initialLocation = { lat: latitude, lng: longitude };
        map = new google.maps.Map(document.getElementById("map"), {
          center: initialLocation,
          zoom: 8,
        });

        geocoder = new google.maps.Geocoder();

        // Place a marker at the initial location
        new google.maps.Marker({
          position: initialLocation,
          map: map,
        });

        // Geocode the initial location
        geocodeLatLng(initialLocation);
      }

      function geocodeLatLng(location) {
        geocoder.geocode({ location: location }, (results, status) => {
          if (status === "OK") {
            if (results[0]) {
              const locationName = results[0].formatted_address;
              document.getElementById("location-name").innerText = locationName;
            } else {
              document.getElementById("location-name").innerText = "No results found";
            }
          } else {
            document.getElementById("location-name").innerText = "Geocoder failed due to: " + status;
          }
        });
      }
    </script>
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 100vh; /* Full viewport height */
        width: 100vw;  /* Full viewport width */
      }
    </style>
</head>
<body>
    <div id="map"></div>
</body>
</html>
